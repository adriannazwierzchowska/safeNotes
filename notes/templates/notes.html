{% extends "base.html" %}

{% block body %}
<div class="container">
    <h3>These are your notes.</h3>
    {% for note in notes %}
        <div class="note">
        <h3>{{ note.title | safe }}</h3>
        <p>
            {% if not note.is_encrypted %}
                {{ note.clean_content | safe }}
            {% else %}
                <i>Encrypted note (decrypt to view)</i>
            {% endif %}
        </p>
        {% if note.is_encrypted %}
        <form action="{{ url_for('main.decrypt_notes', note_id=note.id) }}" method="POST">
            {{ decrypt_form.hidden_tag() }}
            <div>
                {{ decrypt_form.code.label }}
                {{ decrypt_form.code() }}
                {{ decrypt_form.submit() }}
            </div>
        </form>
        {% endif %}
        <p>Written by: {{ note.get_username() }}</p>
        {% if note.note_access|length > 0 %}
        <p>Shared with:
            {% for shared_note in note.note_access %}
                {{ shared_note.get_shared_username() }}{% if not loop.last %}, {% endif %}
            {% endfor %}
        </p>
        {% endif %}
        </div>
    {% endfor %}

</div>
{% endblock %}
